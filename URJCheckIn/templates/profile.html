
<h2 id="maintitle">
	Perfil de {{profile.user.first_name}} {{profile.user.last_name}}
</h2>

<div class="row">
	<div id="profile">
		<div class="col-xs-6 col-xs-offset-3 col-sm-3 col-sm-offset-1">
			<img src="{{ MEDIA_URL }}{profile.user.photo.url}" alt="foto de perfil" alt="foto de perfil" class="img-rounded img-responsive"><!--TODO url imagen-->
		</div>
		<dl class="dl-horizontal fields col-xs-12 col-sm-8 col-sm-offset-0">
			<div class="span2 well">
			<dt>Nombre: </dt>
			<dd id="name_profile">{{profile.user.first_name}} {{profile.user.last_name}}</dd>
			<dt>Edad: </dt>
			<dd id="age_profile">{{profile.age}}</dd>
			<dt>Descripci&oacute;n: </dt>
			<dd id="desc_profile">{{profile.description}}</dd>
			{% if profile.is_student %}
				<dt>Estudia: </dt>
				<dd>
					{% for degree in profile.degrees.all %}
						{% if not forloop.first %}
							,
						{% endif %}
						{{degree.name}}
					{% endfor %}
				</dd>
			{% else %}
				<dt>Ense&ntilde;a: </dt>
				<dd>
					<ul id="degrees_list">
						{% for degree in profile.degrees.all %}
							<li class="degree">{{degree.name}}</li>
						{% endfor %}
					</ul>
				</dd>
			{% endif %}
			</div>
		</dl>
	</div>
</div>

{%if request.user == profile.user %}
	<a name="show_form" class="btn btn-primary btn-block hidden" onclick="showEditProfile('{{profile.user.id}}');return false;" id="show_form" href="/profile/edit">
		<span class="glyphicon glyphicon-pencil"></span> Editar perfil
	</a>
	<div id="editing_profile">
		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<div class="span2 well">
					<form name="photo_form" id="photo_form"
							onsubmit="return false;//TODO" action="PONER-URL-TODO" method="POST">
						{% csrf_token %}
						<fieldset>
							<legend>Imagen de perfil</legend>
							<input class="btn btn-default btn-block" type="file" accept="image/*"/>
						</fieldset>
						<br/>
						<!--TODO enviar para cambiar foto-->
						<button type="submit" name="checkin_submit" id="save_image" 
								class="btn btn-success btn-block">
							<span class="glyphicon glyphicon-save"></span> Cambiar foto
						</button>
					</form>
				</div>
			</div>
		</div>
	
		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<div class="span2 well">
					<form name="profile_form" class="form-horizontal" id="profile_form" 
							onsubmit="sendChanges('{{profile.user.id}}'); return false;" 
							action="" method="POST">
						{% csrf_token %}
						<fieldset>
							<legend>Informaci&oacute;n del perfil</legend>
							<div class="form-group">
								<label for="id_name" class="col-sm-2 control-label">Nombre:</label>
								<div class="col-sm-10">
									<input id="id_name" type="text" name="name" maxlength="30"
									 disabled="disabled" 
									value="{{profile.user.first_name}} {{profile.user.last_name}}">
								</div>
							</div>

							<div id="group_age" class="form-group">
								<label for="id_age" class="col-sm-2 control-label">Edad:</label>
								<div class="col-sm-10">
									{{form.age}}
								</div>
							</div>
				
							<div id="group_description" class="form-group">
								<label for="id_description" class="col-sm-2 control-label">Descripci&oacute;n:</label>
								<div class="col-sm-10">
									{{form.description}}
								</div>
							</div>
						</fieldset>
						<button type="submit" name="checkin_submit" id="save_changes" 
								class="btn btn-success btn-block">
							<span class="glyphicon glyphicon-save"></span>Guardar Cambios
						</button>
					</form>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<div class="span2 well">
					<form name="password_form" class="form-horizontal" id="password_form"
							 onsubmit="changePassword(); return false;"
							 action="/password_change/" method="POST">
						{% csrf_token %}
						<fieldset>
							<legend>Cambiar contrase&ntilde;a</legend>
							<div id="group_old_password" class="form-group">
								<label class="col-sm-3 control-label"
								 for="old_password">
									Contrase&ntilde;a antigua:
								</label>
								<div class="col-sm-9">
									<input id="old_password" type="password" maxlength="4096" name="old_password">
								</div>
							</div>
						
							<div id="group_new_password1" class="form-group">
								<label class="col-sm-3 control-label"
								 for="id_new_password1">
									Contrase&ntilde;a nueva:
								</label>
								<div class="col-sm-9">
									<input id="new_password1" type="password" maxlength="4096" name="new_password1">
								</div>
							</div>
						
							<div id="group_new_password2" class="form-group">
								<label class="col-sm-3 control-label" for="new_password2">Repetir contrase&ntilde;a:</label>
								<div class="col-sm-9">
									<input id="new_password2" type="password" maxlength="4096" name="new_password2">
								</div>
							</div>
						</fieldset>
						<button type="submit" name="checkin_submit" id="password_button" 
								class="btn btn-success btn-block">
							<span class="glyphicon glyphicon-save"></span> Cambiar contrase&ntilde;a
						</button>
					</form>
				</div>
			</div>
		</div>
		<button name="show_form" class="btn btn-danger btn-block" 
							onclick="cancelEditProfile('{{profile.user.id}}')" id="hide_form">
				<span class="glyphicon glyphicon-remove"></span> Cancelar y volver al perfil
		</button>
	</div>
	<!--
	<script src='/jscript/basic.js' type='text/javascript'script>
	<script src='/jscript/edit_profile.js' type='text/javascript'script>
	-->
	<br/>

	<!-- si hay javascript esconde la edicion de perfil, que se podra mostrar
		pulsando el boton, en caso contrario se mostrara -->
	<script>
		cancelEditProfile('{{profile.user.id}}');
	</script>
{%endif%}

