
<h2 id="maintitle">Clases de {{subject}} <br/>
	<small>Accede a la informaci&oacute;n de las clases</small>
</h2>

<div id="subject_info" class="row">
	<dl class="dl-horizontal col-xs-12 fields">
		<div class="span2 well">
			<dt>Nombre: </dt> <dd>{{subject.name}} </dd>
			<dt>N&uacute;mero de alumnos: </dt> <dd>{{subject.n_students}} </dd>
			<dt>Grado{{subject.degrees.all|length|pluralize}}: </dt>
			<dd>
				<ul id="degrees_list">
					{%for degree in subject.degrees.all%}
						<li>
							{{degree.name}}
						</li>
					{% empty %}
						La asignatura no es impartida por ning&uacute;n profesor.
					{%endfor%}
				</ul>
			</dd>
			<dt>Profesor{{profesors|length|pluralize:"es"}}: </dt>
			<dd>
				<ul id="profesor_list">
					{%for prof in profesors%}
						<li>
							<a onClick="ask_ajax_page('profile', loadAjaxPage, 
							{'iduser': '{{prof.user.id}}'}); return false;" 
							href="/profile/view/{{prof.user.id}}">
								{{prof.user.first_name}} {{prof.user.last_name}}
							</a>
						</li>
					{% empty %}
						La asignatura no es impartida por ning&uacute;n profesor.
					{%endfor%}
				</ul>
			</dd>
			{% if subject.is_seminar %}
				<dt>Plazas ocupadas: </dt> <dd>{{subject.n_students}}/{{subject.max_students}}</dd>
				<dt>Descripci&oacute;n: </dt> <dd>{{subject.description}}</dd>

				<!--El creador del seminario puede modificarlo-->
				{% if profile.user == subject.creator %}
					<!--TODO-->
					eliminar seminario
					editar fecha inicio/fin
				{% endif %}
				<!--Si aun no ha empezado los alumnos pueden apuntarse/desapuntarse si hay plaza
					y los profesores pueden apuntarse como ponentes-->
				{% if not started %}
					{% if profile.is_student %}
						{% if signed %}
							<div class="row">
								<form name="sign_seminar" action="" method="POST"
										 onsubmit="changeStateSeminar({{subject.id}}); return false;">
									{% csrf_token %}
									<button name="sign_up_seminar" class="btn btn-danger btn-block" 
										onclick="signUpSeminar('{{profile.user.id}}')">
										<span class="glyphicon glyphicon-remove-circle"></span> Desapuntarme
									</button>
								</form>
							</div>
						{% elif subject.n_students < subject.max_students %}			
							<div class="row">
								<form name="sign_seminar" action="" method="POST"
									 onsubmit="changeStateSeminar({{subject.id}}); return false;">
									{% csrf_token %}
									<button name="sign_seminar" class="btn btn-success btn-block" 
										onclick="signUpSeminar('{{profile.user.id}}')">
										<span class="glyphicon glyphicon-ok-circle"></span> Apuntarme
									</button>
								</form>
							</div>
						{% endif %}
					{% elif profile.user != subject.creator and not signed %}
						<div class="row">
							<form name="sign_seminar" action="" method="POST"
								 onsubmit="changeStateSeminar({{subject.id}}); return false;">
								{% csrf_token %}
								<button name="sign_seminar" class="btn btn-success btn-block" 
									onclick="signUpSeminar('{{profile.user.id}}')">
									<span class="glyphicon glyphicon-ok-circle"></span> Hacerme organizador
								</button>
							</form>
						</div>
					{% endif %}
				{% endif %}
			{% endif %}
		</div>
	</dl>
</div>

<div id="classes">
	{%if classes_n%}
	<div class="row">
		<div class="col-xs-12">
			<div class="panel panel-danger">
				<div class="panel-heading">
					<h3 class="panel-title">Clases imparti&eacute;ndose</h3>
				</div>
				<ul class="subjects_list list-group classes_list">
					{% for class in classes_n %}
						<a onClick="ask_ajax_page('class_info', loadAjaxPage, {'idclass': {{class.id}}}); return false;" href="/class/{{class.id}}" class="list-group-item">
							{{class.start_time|date:'d-m-Y H:i'}}/{{class.end_time|date:'H:i'}}
						</a>
					{% endfor %}
				</ul>
			</div>
		</div>
	</div>
	{%endif%}

	<div class="row">
		<div class="col-sm-6">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h3 class="panel-title">Pr&oacute;ximas clases</h3>
				</div>
				<ul class="subjects_list list-group classes_list">
					{% for class in classes_f%}
						<a onClick="ask_ajax_page('class_info', loadAjaxPage, {'idclass': {{class.id}}}); return false;" href="/class/{{class.id}}" class="list-group-item">
							{{class.start_time|date:'d-m-Y H:i'}}/{{class.end_time|date:'H:i'}}
							 dentro de {{ class.start_time|timeuntil }}
						</a>
					{%empty%}
						<li class="list-group-item">No hay clases programadas</li>
					{% endfor %}
				</ul>
				<div class="panel-footer">
					<a href="#" class="btn btn-primary btn-sm btn-block" role="button">
						<span class="glyphicon glyphicon-refresh"></span> Siguientes clases
					</a>
				</div>
				<!--TODO funcionalidad boton para cargar mas-->
			</div>
		</div>

		<div class="col-sm-6">
			<div class="panel panel-success">
				<div class="panel-heading">
					<h3 class="panel-title">&Uacute;ltimas clases</h3>
				</div>
				<ul class="subjects_list list-group classes_list">
					{% for class in classes_p %}
						<a onClick="ask_ajax_page('class_info', loadAjaxPage, {'idclass': {{class.id}}}); return false;" href="/class/{{class.id}}" class="list-group-item">
							{{class.start_time|date:'d-m-Y H:i'}}/{{class.end_time|date:'H:i'}}
						</a>
					{%empty%}
						<li class="list-group-item">Todav&iacute;a no ha habido clases</li>
					{% endfor %}
				</ul>
				<div class="panel-footer">
					<a href="#" class="btn btn-primary btn-sm btn-block" role="button">
						<span class="glyphicon glyphicon-refresh"></span> Clases anteriores
					</a>
				</div>
				<!--TODO funcionalidad boton para cargar mas-->
		</div>
	</div>
</div>
